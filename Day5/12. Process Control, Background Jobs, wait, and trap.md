# 12. Process Control, Background Jobs, wait, and trap

## 12.1 Running Processes
- Every command in Linux runs as a **process**
- Use `ps` to list processes:
```bash
ps aux | grep bash
```
- `top` or `htop` for real-time process monitoring

---

## 12.2 Background Jobs
- Run a process in the **background** using `&`
```bash
sleep 30 &
```
- `jobs` → list background jobs
- `fg %1` → bring job 1 to foreground
- `bg %1` → resume job 1 in background

### Example
```bash
#!/bin/bash
echo "Starting background task..."
sleep 10 &
echo "This runs immediately"
```

---

## 12.3 wait Command
- Wait for background jobs to finish
```bash
sleep 5 &
sleep 10 &
wait
echo "All background jobs finished"
```
- Can wait for a **specific job**: `wait %1`
- Returns exit status of waited process

---

## 12.4 trap Command
- Catch signals and perform cleanup

### Syntax
```bash
trap 'commands' SIGNAL
```
- SIGNAL examples: `SIGINT` (Ctrl+C), `SIGTERM`, `EXIT`

### Example
```bash
#!/bin/bash
trap 'echo "Script interrupted"; exit 1' SIGINT

while true; do
    echo "Running..."
    sleep 2
done
```
- Press Ctrl+C → `Script interrupted` is printed before exit

### Cleanup on Exit
```bash
trap 'rm -f /tmp/tempfile; echo "Cleaned up"' EXIT
```
- Runs when the script exits normally or via signal

---

## Practical Examples
1. Background download:
```bash
wget http://example.com/file.zip &
echo "Download started in background"
```
2. Wait for multiple jobs:
```bash
sleep 5 &
sleep 7 &
wait
echo "Both jobs done"
```
3. Trap SIGINT to handle Ctrl+C:
```bash
trap 'echo "Exiting script"; exit 0' SIGINT
while true; do sleep 1; done
```

---

## Summary
- **Background jobs (`&`)** allow concurrent execution
- **jobs, fg, bg** → manage jobs
- **wait** → wait for job completion
- **trap** → catch signals and execute cleanup
- Process control ensures scripts **handle multitasking and signals safely**

